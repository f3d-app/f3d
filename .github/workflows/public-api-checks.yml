name: Public API check
on: pull_request
jobs:

  public-api-check:
    name: Public API Check
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
    - uses: actions/checkout@v3

    - name: Check Public API Changed
      id: should_warn
      working-directory: ${{github.workspace}}
      shell: bash
      run: test -z "$(git diff --name-only HEAD master | grep library/public/.*.h)" && echo "should_warn=true" >> $GITHUB_OUTPUT || echo "should_warn=false" >> $GITHUB_OUTPUT

    - uses: thollander/actions-comment-pull-request@v2
      if: ${{ steps.should_warn.outputs.should_warn == 'true' }}
      with:
        message: You are modifying libf3d public API :warning:! Please update bindings accordingly !
