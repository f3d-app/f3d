/**
 * This file is auto-generated by CMake, do not edit directly.
 */

#ifndef F3D@F3D_READER_NAME@_h
#define F3D@F3D_READER_NAME@_h

#include "reader.h"

#include "F3DUtils.h"

#if @F3D_READER_HAS_GEOMETRY_READER@
#include <@F3D_READER_VTK_READER@.h>
#endif

#if @F3D_READER_HAS_SCENE_READER@
#include <@F3D_READER_VTK_IMPORTER@.h>
#endif

#include <vtkMemoryResourceStream.h>
#include <vtkVersion.h>
#include <vtksys/SystemTools.hxx>

class reader_@F3D_READER_NAME@ : public f3d::reader
{
public:
  reader_@F3D_READER_NAME@()
  {
    this->ReaderOptions = { @F3D_READER_OPTIONS@ };
  }

  /*
   * Get the name of this reader
   */
  const std::string getName() const override { return "@F3D_READER_NAME@"; }

  /*
   * Get the short description of this reader
   */
  const std::string getShortDescription() const override { return "@F3D_READER_FORMAT_DESCRIPTION@"; }

  /*
   * Get the extensions supported by this reader
   */
  const std::vector<std::string> getExtensions() const override
  {
    static const std::vector<std::string> ext = { @F3D_READER_EXTENSIONS@ };
    return ext;
  }

  /*
   * Get the mimetypes supported by this reader
   */
  const std::vector<std::string> getMimeTypes() const override
  {
    static const std::vector<std::string> types = { @F3D_READER_MIMETYPES@ };
    return types;
  }

#if @F3D_READER_HAS_SCORE@
  /*
   * Get the score of this reader.
   * The score is used in case several readers are able to read the file.
   * The reader having the highest score (from 0 to 100) is used to read the file.
   * Default is 50.
   */
  int getScore() const override
  {
    return @F3D_READER_SCORE@;
  }
#endif

#if @F3D_READER_HAS_GEOMETRY_READER@
  /**
   * Return true if this reader can create a geometry reader
   * false otherwise
   */
  bool hasGeometryReader() override
  {
    return true;
  }

  using f3d::reader::createGeometryReader;

  /*
   * Create the geometry reader (VTK reader) for the given filename
   * The filename is collapsed as some VTK reader needs it to read reliably TODO add issue
   */
  vtkSmartPointer<vtkAlgorithm> createGeometryReader(const std::string& fileName) const override
  {
    vtkNew<@F3D_READER_VTK_READER@> geomReader;
    geomReader->SetFileName(vtksys::SystemTools::CollapseFullPath(fileName).c_str());

    this->applyCustomReader(geomReader, fileName, nullptr);

    return geomReader;
  }

#if @F3D_READER_HAS_SUPPORTS_STREAM@
  /*
   * Create the geometry reader (VTK reader) for the given stream
   */
  vtkSmartPointer<vtkAlgorithm> createGeometryReader(vtkResourceStream* stream) const override
  {
    vtkNew<@F3D_READER_VTK_READER@> geomReader;
    geomReader->SetStream(stream);

    this->applyCustomReader(geomReader, "", stream);

    return geomReader;
  }

#endif
#endif

#if @F3D_READER_HAS_SCENE_READER@
  /**
   * Return true if this reader can create a scene reader
   * false otherwise
   */
  bool hasSceneReader() override
  {
    return true;
  }

  using f3d::reader::createSceneReader;
  /*
   * Create the scene reader (VTK importer) for the given filename
   * The filename is collapsed as some VTK reader needs it to read reliably TODO add issue
   */
  vtkSmartPointer<vtkImporter> createSceneReader(const std::string& fileName) const override
  {
    vtkNew<@F3D_READER_VTK_IMPORTER@> importer;
    importer->SetFileName(vtksys::SystemTools::CollapseFullPath(fileName).c_str());

    this->applyCustomImporter(importer, fileName, nullptr);

    return importer;
  }

#if @F3D_READER_HAS_SUPPORTS_STREAM@
  /*
   * Create the scene reader (VTK importer) for the given stream
   */
  vtkSmartPointer<vtkImporter> createSceneReader(vtkResourceStream* stream) const override
  {
    vtkNew<@F3D_READER_VTK_IMPORTER@> importer;
    importer->SetStream(stream);

    this->applyCustomImporter(importer, "", stream);

    return importer;
  }
#endif
#endif

#if @F3D_READER_HAS_SUPPORTS_STREAM@
  /**
   * Return true if this reader supports stream
   * false otherwise
   */
  bool supportsStream() const override
  {
    return true;
  }

#if @F3D_READER_HAS_STANDARD_CAN_READ@
  using reader::canRead;
  /**
   * Return true if this reader could be able to read provided stream,
   * false if it is sure it cannot.
   */
  bool canRead([[maybe_unused]] vtkResourceStream* stream) const override
  {
#if VTK_VERSION_NUMBER >= VTK_VERSION_CHECK(9, 6, 20260128)
#if @F3D_READER_HAS_GEOMETRY_READER@
    return @F3D_READER_VTK_READER@::CanReadFile(stream);
#else // F3D_READER_HAS_GEOMETRY_READER
#if @F3D_READER_HAS_SCENE_READER@
    return @F3D_READER_VTK_IMPORTER@::CanReadFile(stream);
#endif
#endif
#else // VTK_VERSION
    return true;
#endif
  }
#endif
#endif

#if @F3D_READER_HAS_CUSTOM_CODE@
#include "@F3D_READER_CUSTOM_CODE@"
#endif

};

#endif
